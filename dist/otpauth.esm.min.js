/*! otpauth v6.3.0 | (c) Héctor Molinero Fernández <hector@molinero.dev> | MIT | https://github.com/hectorm/otpauth */
/*! jssha v3.2.0 | (c) Brian Turek <brian.turek@gmail.com> | BSD-3-Clause | https://github.com/Caligatio/jsSHA */
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){
(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}var Utils={uint:{fromBuf:function(t){for(var e=new Uint8Array(t),n=0,r=0;r<e.length;r++)0!==e[r]&&(n*=256,n+=e[r]);return n},toBuf:function(t){for(var e=new ArrayBuffer(8),n=new Uint8Array(e),r=t,i=7;i>=0&&0!==r;i--)n[i]=255&r,r-=n[i],r/=256
;return e}},raw:{fromBuf:function(t){for(var e=new Uint8Array(t),n="",r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return n},toBuf:function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return e}},b32:{alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",fromBuf:function(t){for(var e=new Uint8Array(t),n=0,r=0,i="",o=0;o<e.length;o++)for(r=r<<8|e[o],n+=8;n>=5;)i+=Utils.b32.alphabet[r>>>n-5&31],n-=5;return n>0&&(i+=Utils.b32.alphabet[r<<5-n&31]),i},toBuf:function(t){t=t.toUpperCase().replace(/=+$/,"");for(var e=new ArrayBuffer(5*t.length/8|0),n=new Uint8Array(e),r=0,i=0,o=0,s=0;s<t.length;s++){var u=Utils.b32.alphabet.indexOf(t[s]);if(-1===u)throw new TypeError("Invalid character found: ".concat(t[s]));i=i<<5|u,(r+=5)>=8&&(n[o++]=i>>>r-8&255,r-=8)}return e}},hex:{fromBuf:function(t){for(var e=new Uint8Array(t),n="",r=0;r<e.length;r++){var i=e[r].toString(16);n+=2===i.length?i:"0".concat(i)}return n.toUpperCase()},toBuf:function(t){
for(var e=new ArrayBuffer(t.length/2),n=new Uint8Array(e),r=0,i=0;r<n.length;r+=1,i+=2)n[r]=parseInt(t.substr(i,2),16);return e}},pad:function(t,e){for(var n="",r=e-String(t).length;r-- >0;)n+="0";return"".concat(n).concat(t)}},InternalUtils={get globalThis(){var t;if("object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis)))t=globalThis;else{Object.defineProperty(Object.prototype,"__magicalGlobalThis__",{get:function(){return this},configurable:!0});try{t=__magicalGlobalThis__}finally{delete Object.prototype.__magicalGlobalThis__}}return void 0===t&&("undefined"!=typeof self?t=self:"undefined"!=typeof window?t=window:"undefined"!=typeof global&&(t=global)),Object.defineProperty(this,"globalThis",{enumerable:!0,value:t}),this.globalThis},get console(){var t={},e=["assert","clear","context","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeLog","timeStamp","trace","warn"]
;if("object"===_typeof(InternalUtils.globalThis.console)){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;t[i]="function"==typeof InternalUtils.globalThis.console[i]?InternalUtils.globalThis.console[i]:function(){}}}catch(t){r.e(t)}finally{r.f()}}else{var o,s=_createForOfIteratorHelper(e);try{for(s.s();!(o=s.n()).done;){t[o.value]=function(){}}}catch(t){s.e(t)}finally{s.f()}}return Object.defineProperty(this,"console",{enumerable:!0,value:t}),this.console},get isNode(){var t="[object process]"===Object.prototype.toString.call(InternalUtils.globalThis.process);return Object.defineProperty(this,"isNode",{enumerable:!0,value:t}),this.isNode},get nodeRequire(){var _nodeRequire=InternalUtils.isNode?eval("require"):function(){};return Object.defineProperty(this,"nodeRequire",{enumerable:!0,value:_nodeRequire}),this.nodeRequire}};const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function n(t,e,n,r){let i,o,s;const u=e||[0],a=(n=n||0)>>>3,h=-1===r?3:0
;for(i=0;i<t.length;i+=1)s=i+a,o=s>>>2,u.length<=o&&u.push(0),u[o]|=t[i]<<8*(h+r*(s%4));return{value:u,binLen:8*t.length+n}}function e(e,r,i){switch(r){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(t,e,n){return function(t,e,n,r){let i,o,s,u;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");const a=e||[0],h=(n=n||0)>>>3,l=-1===r?3:0;for(i=0;i<t.length;i+=2){if(o=parseInt(t.substr(i,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(u=(i>>>1)+h,s=u>>>2;a.length<=s;)a.push(0);a[s]|=o<<8*(l+r*(u%4))}return{value:a,binLen:4*t.length+n}}(t,e,n,i)};case"TEXT":return function(t,e,n){return function(t,e,n,r,i){let o,s,u,a,h,l,c,f,w=0;const p=n||[0],d=(r=r||0)>>>3;if("UTF8"===e)for(c=-1===i?3:0,u=0;u<t.length;u+=1)for(o=t.charCodeAt(u),s=[],128>o?s.push(o):2048>o?(s.push(192|o>>>6),
s.push(128|63&o)):55296>o||57344<=o?s.push(224|o>>>12,128|o>>>6&63,128|63&o):(u+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(u)),s.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),a=0;a<s.length;a+=1){for(l=w+d,h=l>>>2;p.length<=h;)p.push(0);p[h]|=s[a]<<8*(c+i*(l%4)),w+=1}else for(c=-1===i?2:0,f="UTF16LE"===e&&1!==i||"UTF16LE"!==e&&1===i,u=0;u<t.length;u+=1){for(o=t.charCodeAt(u),!0===f&&(a=255&o,o=a<<8|o>>>8),l=w+d,h=l>>>2;p.length<=h;)p.push(0);p[h]|=o<<8*(c+i*(l%4)),w+=2}return{value:p,binLen:8*w+r}}(t,r,e,n,i)};case"B64":return function(e,n,r){return function(e,n,r,i){let o,s,u,a,h,l,c,f=0;const w=n||[0],p=(r=r||0)>>>3,d=-1===i?3:0,g=e.indexOf("=");if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(e=e.replace(/=/g,""),-1!==g&&g<e.length)throw new Error("Invalid '=' found in base-64 string");for(s=0;s<e.length;s+=4){for(h=e.substr(s,4),a=0,u=0;u<h.length;u+=1)o=t.indexOf(h.charAt(u)),a|=o<<18-6*u;for(u=0;u<h.length-1;u+=1){for(c=f+p,
l=c>>>2;w.length<=l;)w.push(0);w[l]|=(a>>>16-8*u&255)<<8*(d+i*(c%4)),f+=1}}return{value:w,binLen:8*f+r}}(e,n,r,i)};case"BYTES":return function(t,e,n){return function(t,e,n,r){let i,o,s,u;const a=e||[0],h=(n=n||0)>>>3,l=-1===r?3:0;for(o=0;o<t.length;o+=1)i=t.charCodeAt(o),u=o+h,s=u>>>2,a.length<=s&&a.push(0),a[s]|=i<<8*(l+r*(u%4));return{value:a,binLen:8*t.length+n}}(t,e,n,i)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t,e,r){return function(t,e,r,i){return n(new Uint8Array(t),e,r,i)}(t,e,r,i)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t,e,r){return n(t,e,r,i)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function r(e,n,r,i){switch(e){case"HEX":return function(t){return function(t,e,n,r){let i,o,s="";const u=e/8,a=-1===n?3:0;for(i=0;i<u;i+=1)o=t[i>>>2]>>>8*(a+n*(i%4)),
s+="0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o);return r.outputUpper?s.toUpperCase():s}(t,n,r,i)};case"B64":return function(e){return function(e,n,r,i){let o,s,u,a,h,l="";const c=n/8,f=-1===r?3:0;for(o=0;o<c;o+=3)for(a=o+1<c?e[o+1>>>2]:0,h=o+2<c?e[o+2>>>2]:0,u=(e[o>>>2]>>>8*(f+r*(o%4))&255)<<16|(a>>>8*(f+r*((o+1)%4))&255)<<8|h>>>8*(f+r*((o+2)%4))&255,s=0;s<4;s+=1)l+=8*o+6*s<=n?t.charAt(u>>>6*(3-s)&63):i.b64Pad;return l}(e,n,r,i)};case"BYTES":return function(t){return function(t,e,n){let r,i,o="";const s=e/8,u=-1===n?3:0;for(r=0;r<s;r+=1)i=t[r>>>2]>>>8*(u+n*(r%4))&255,o+=String.fromCharCode(i);return o}(t,n,r)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t){return function(t,e,n){let r;const i=e/8,o=new ArrayBuffer(i),s=new Uint8Array(o),u=-1===n?3:0;for(r=0;r<i;r+=1)s[r]=t[r>>>2]>>>8*(u+n*(r%4))&255;return o}(t,n,r)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){
throw new Error("UINT8ARRAY not supported by this environment")}return function(t){return function(t,e,n){let r;const i=e/8,o=-1===n?3:0,s=new Uint8Array(i);for(r=0;r<i;r+=1)s[r]=t[r>>>2]>>>8*(o+n*(r%4))&255;return s}(t,n,r)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}
const i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],o=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],h="Chosen SHA variant is not supported";function u(t,e){let n,r;const i=t.binLen>>>3,o=e.binLen>>>3,s=i<<3,u=4-i<<3;if(i%4!=0){
for(n=0;n<o;n+=4)r=i+n>>>2,t.value[r]|=e.value[n>>>2]<<s,t.value.push(0),t.value[r+1]|=e.value[n>>>2]>>>u;return(t.value.length<<2)-4>=o+i&&t.value.pop(),{value:t.value,binLen:t.binLen+e.binLen}}return{value:t.value.concat(e.value),binLen:t.binLen+e.binLen}}function w(t){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},n=t||{},r="Output length must be a multiple of 8";if(e.outputUpper=n.outputUpper||!1,n.b64Pad&&(e.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(r);e.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(r);e.outputLen=n.shakeLen}if("boolean"!=typeof e.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof e.b64Pad)throw new Error("Invalid b64Pad formatting option");return e}function c(t,n,r,i){const o=t+" must include a value and format";if(!n){if(!i)throw new Error(o);return i}if(void 0===n.value||!n.format)throw new Error(o);return e(n.format,n.encoding||"UTF8",r)(n.value)}class f{constructor(t,e,n){const r=n||{}
;if(this.t=e,this.i=r.encoding||"UTF8",this.numRounds=r.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.s=t,this.o=[],this.h=0,this.u=!1,this.l=0,this.A=!1,this.H=[],this.S=[]}update(t){let e,n=0;const r=this.p>>>5,i=this.m(t,this.o,this.h),o=i.binLen,s=i.value,u=o>>>5;for(e=0;e<u;e+=r)n+this.p<=o&&(this.C=this.R(s.slice(e,e+r),this.C),n+=this.p);this.l+=n,this.o=s.slice(n>>>5),this.h=o%this.p,this.u=!0}getHash(t,e){let n,i,o=this.U;const s=w(e);if(this.v){if(-1===s.outputLen)throw new Error("Output length must be specified in options");o=s.outputLen}const u=r(t,o,this.K,s);if(this.A&&this.T)return u(this.T(s));for(i=this.F(this.o.slice(),this.h,this.l,this.g(this.C),o),n=1;n<this.numRounds;n+=1)this.v&&o%32!=0&&(i[i.length-1]&=16777215>>>24-o%32),i=this.F(i,o,0,this.B(this.s),o);return u(i)}setHMACKey(t,n,r){if(!this.L)throw new Error("Variant does not support HMAC")
;if(this.u)throw new Error("Cannot set MAC key after calling update");const i=e(n,(r||{}).encoding||"UTF8",this.K);this.M(i(t))}M(t){const e=this.p>>>3,n=e/4-1;let r;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(e<t.binLen/8&&(t.value=this.F(t.value,t.binLen,0,this.B(this.s),this.U));t.value.length<=n;)t.value.push(0);for(r=0;r<=n;r+=1)this.H[r]=909522486^t.value[r],this.S[r]=1549556828^t.value[r];this.C=this.R(this.H,this.C),this.l=this.p,this.A=!0}getHMAC(t,e){const n=w(e);return r(t,this.U,this.K,n)(this.k())}k(){let t;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");const e=this.F(this.o.slice(),this.h,this.l,this.g(this.C),this.U);return t=this.R(this.S,this.B(this.s)),t=this.F(e,this.U,this.p,t,this.U),t}}function a(t,e){return t<<e|t>>>32-e}function l(t,e){return t>>>e|t<<32-e}function A(t,e){return t>>>e}function E(t,e,n){return t^e^n}function H(t,e,n){return t&e^~t&n}function S(t,e,n){
return t&e^t&n^e&n}function b(t){return l(t,2)^l(t,13)^l(t,22)}function p(t,e){const n=(65535&t)+(65535&e);return(65535&(t>>>16)+(e>>>16)+(n>>>16))<<16|65535&n}function d(t,e,n,r){const i=(65535&t)+(65535&e)+(65535&n)+(65535&r);return(65535&(t>>>16)+(e>>>16)+(n>>>16)+(r>>>16)+(i>>>16))<<16|65535&i}function m(t,e,n,r,i){const o=(65535&t)+(65535&e)+(65535&n)+(65535&r)+(65535&i);return(65535&(t>>>16)+(e>>>16)+(n>>>16)+(r>>>16)+(i>>>16)+(o>>>16))<<16|65535&o}function C(t){return l(t,7)^l(t,18)^A(t,3)}function y(t){return l(t,6)^l(t,11)^l(t,25)}function R(t){return[1732584193,4023233417,2562383102,271733878,3285377520]}function U(t,e){let n,r,i,o,s,u,h;const l=[];for(n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],h=0;h<80;h+=1)l[h]=h<16?t[h]:a(l[h-3]^l[h-8]^l[h-14]^l[h-16],1),u=h<20?m(a(n,5),H(r,i,o),s,1518500249,l[h]):h<40?m(a(n,5),E(r,i,o),s,1859775393,l[h]):h<60?m(a(n,5),S(r,i,o),s,2400959708,l[h]):m(a(n,5),E(r,i,o),s,3395469782,l[h]),s=o,o=i,i=a(r,30),r=n,n=u;return e[0]=p(n,e[0]),e[1]=p(r,e[1]),e[2]=p(i,e[2]),
e[3]=p(o,e[3]),e[4]=p(s,e[4]),e}function v(t,e,n,r){let i;const o=15+(e+65>>>9<<4),s=e+n;for(;t.length<=o;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[o]=4294967295&s,t[o-1]=s/4294967296|0,i=0;i<t.length;i+=16)r=U(t.slice(i,i+16),r);return r}class K extends f{constructor(t,n,r){if("SHA-1"!==t)throw new Error(h);super(t,n,r);const i=r||{};this.L=!0,this.T=this.k,this.K=-1,this.m=e(this.t,this.i,this.K),this.R=U,this.g=function(t){return t.slice()},this.B=R,this.F=v,this.C=[1732584193,4023233417,2562383102,271733878,3285377520],this.p=512,this.U=160,this.v=!1,i.hmacKey&&this.M(c("hmacKey",i.hmacKey,this.K))}}function T(t){let e;return e="SHA-224"==t?s.slice():o.slice(),e}function F(t,e){let n,r,o,s,u,a,h,c,f,w,g;const B=[];for(n=e[0],r=e[1],o=e[2],s=e[3],u=e[4],a=e[5],h=e[6],c=e[7],g=0;g<64;g+=1)B[g]=g<16?t[g]:d(l(v=B[g-2],17)^l(v,19)^A(v,10),B[g-7],C(B[g-15]),B[g-16]),f=m(c,y(u),H(u,a,h),i[g],B[g]),w=p(b(n),S(n,r,o)),c=h,h=a,a=u,u=p(s,f),s=o,o=r,r=n,n=p(f,w);var v;return e[0]=p(n,e[0]),e[1]=p(r,e[1]),
e[2]=p(o,e[2]),e[3]=p(s,e[3]),e[4]=p(u,e[4]),e[5]=p(a,e[5]),e[6]=p(h,e[6]),e[7]=p(c,e[7]),e}class g extends f{constructor(t,n,r){if("SHA-224"!==t&&"SHA-256"!==t)throw new Error(h);super(t,n,r);const i=r||{};this.T=this.k,this.L=!0,this.K=-1,this.m=e(this.t,this.i,this.K),this.R=F,this.g=function(t){return t.slice()},this.B=T,this.F=function(e,n,r,i){return function(t,e,n,r,i){let o,s;const u=15+(e+65>>>9<<4),a=e+n;for(;t.length<=u;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[u]=4294967295&a,t[u-1]=a/4294967296|0,o=0;o<t.length;o+=16)r=F(t.slice(o,o+16),r);return s="SHA-224"===i?[r[0],r[1],r[2],r[3],r[4],r[5],r[6]]:r,s}(e,n,r,i,t)},this.C=T(t),this.p=512,this.U="SHA-224"===t?224:256,this.v=!1,i.hmacKey&&this.M(c("hmacKey",i.hmacKey,this.K))}}class B{constructor(t,e){this.Y=t,this.N=e}}function L(t,e){let n;return e>32?(n=64-e,new B(t.N<<e|t.Y>>>n,t.Y<<e|t.N>>>n)):0!==e?(n=32-e,new B(t.Y<<e|t.N>>>n,t.N<<e|t.Y>>>n)):t}function M(t,e){let n;return e<32?(n=32-e,new B(t.Y>>>e|t.N<<n,t.N>>>e|t.Y<<n)):(n=64-e,
new B(t.N>>>e|t.Y<<n,t.Y>>>e|t.N<<n))}function k(t,e){return new B(t.Y>>>e,t.N>>>e|t.Y<<32-e)}function Y(t,e,n){return new B(t.Y&e.Y^t.Y&n.Y^e.Y&n.Y,t.N&e.N^t.N&n.N^e.N&n.N)}function N(t){const e=M(t,28),n=M(t,34),r=M(t,39);return new B(e.Y^n.Y^r.Y,e.N^n.N^r.N)}function I(t,e){let n,r;n=(65535&t.N)+(65535&e.N),r=(t.N>>>16)+(e.N>>>16)+(n>>>16);const i=(65535&r)<<16|65535&n;return n=(65535&t.Y)+(65535&e.Y)+(r>>>16),r=(t.Y>>>16)+(e.Y>>>16)+(n>>>16),new B((65535&r)<<16|65535&n,i)}function X(t,e,n,r){let i,o;i=(65535&t.N)+(65535&e.N)+(65535&n.N)+(65535&r.N),o=(t.N>>>16)+(e.N>>>16)+(n.N>>>16)+(r.N>>>16)+(i>>>16);const s=(65535&o)<<16|65535&i;return i=(65535&t.Y)+(65535&e.Y)+(65535&n.Y)+(65535&r.Y)+(o>>>16),o=(t.Y>>>16)+(e.Y>>>16)+(n.Y>>>16)+(r.Y>>>16)+(i>>>16),new B((65535&o)<<16|65535&i,s)}function z(t,e,n,r,i){let o,s;o=(65535&t.N)+(65535&e.N)+(65535&n.N)+(65535&r.N)+(65535&i.N),s=(t.N>>>16)+(e.N>>>16)+(n.N>>>16)+(r.N>>>16)+(i.N>>>16)+(o>>>16);const u=(65535&s)<<16|65535&o
;return o=(65535&t.Y)+(65535&e.Y)+(65535&n.Y)+(65535&r.Y)+(65535&i.Y)+(s>>>16),s=(t.Y>>>16)+(e.Y>>>16)+(n.Y>>>16)+(r.Y>>>16)+(i.Y>>>16)+(o>>>16),new B((65535&s)<<16|65535&o,u)}function x(t,e){return new B(t.Y^e.Y,t.N^e.N)}function _(t){const e=M(t,19),n=M(t,61),r=k(t,6);return new B(e.Y^n.Y^r.Y,e.N^n.N^r.N)}function O(t){const e=M(t,1),n=M(t,8),r=k(t,7);return new B(e.Y^n.Y^r.Y,e.N^n.N^r.N)}function P(t){const e=M(t,14),n=M(t,18),r=M(t,41);return new B(e.Y^n.Y^r.Y,e.N^n.N^r.N)}
const V=[new B(i[0],3609767458),new B(i[1],602891725),new B(i[2],3964484399),new B(i[3],2173295548),new B(i[4],4081628472),new B(i[5],3053834265),new B(i[6],2937671579),new B(i[7],3664609560),new B(i[8],2734883394),new B(i[9],1164996542),new B(i[10],1323610764),new B(i[11],3590304994),new B(i[12],4068182383),new B(i[13],991336113),new B(i[14],633803317),new B(i[15],3479774868),new B(i[16],2666613458),new B(i[17],944711139),new B(i[18],2341262773),new B(i[19],2007800933),new B(i[20],1495990901),new B(i[21],1856431235),new B(i[22],3175218132),new B(i[23],2198950837),new B(i[24],3999719339),new B(i[25],766784016),new B(i[26],2566594879),new B(i[27],3203337956),new B(i[28],1034457026),new B(i[29],2466948901),new B(i[30],3758326383),new B(i[31],168717936),new B(i[32],1188179964),new B(i[33],1546045734),new B(i[34],1522805485),new B(i[35],2643833823),new B(i[36],2343527390),new B(i[37],1014477480),new B(i[38],1206759142),new B(i[39],344077627),new B(i[40],1290863460),new B(i[41],3158454273),new B(i[42],3505952657),new B(i[43],106217008),new B(i[44],3606008344),new B(i[45],1432725776),new B(i[46],1467031594),new B(i[47],851169720),new B(i[48],3100823752),new B(i[49],1363258195),new B(i[50],3750685593),new B(i[51],3785050280),new B(i[52],3318307427),new B(i[53],3812723403),new B(i[54],2003034995),new B(i[55],3602036899),new B(i[56],1575990012),new B(i[57],1125592928),new B(i[58],2716904306),new B(i[59],442776044),new B(i[60],593698344),new B(i[61],3733110249),new B(i[62],2999351573),new B(i[63],3815920427),new B(3391569614,3928383900),new B(3515267271,566280711),new B(3940187606,3454069534),new B(4118630271,4000239992),new B(116418474,1914138554),new B(174292421,2731055270),new B(289380356,3203993006),new B(460393269,320620315),new B(685471733,587496836),new B(852142971,1086792851),new B(1017036298,365543100),new B(1126000580,2618297676),new B(1288033470,3409855158),new B(1501505948,4234509866),new B(1607167915,987167468),new B(1816402316,1246189591)]
;function Z(t){return"SHA-384"===t?[new B(3418070365,s[0]),new B(1654270250,s[1]),new B(2438529370,s[2]),new B(355462360,s[3]),new B(1731405415,s[4]),new B(41048885895,s[5]),new B(3675008525,s[6]),new B(1203062813,s[7])]:[new B(o[0],4089235720),new B(o[1],2227873595),new B(o[2],4271175723),new B(o[3],1595750129),new B(o[4],2917565137),new B(o[5],725511199),new B(o[6],4215389547),new B(o[7],327033209)]}function j(t,e){let n,r,i,o,s,u,a,h,l,c,f,w;const p=[];for(n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],u=e[5],a=e[6],h=e[7],f=0;f<80;f+=1)f<16?(w=2*f,p[f]=new B(t[w],t[w+1])):p[f]=X(_(p[f-2]),p[f-7],O(p[f-15]),p[f-16]),l=z(h,P(s),(g=u,m=a,new B((d=s).Y&g.Y^~d.Y&m.Y,d.N&g.N^~d.N&m.N)),V[f],p[f]),c=I(N(n),Y(n,r,i)),h=a,a=u,u=s,s=I(o,l),o=i,i=r,r=n,n=I(l,c);var d,g,m;return e[0]=I(n,e[0]),e[1]=I(r,e[1]),e[2]=I(i,e[2]),e[3]=I(o,e[3]),e[4]=I(s,e[4]),e[5]=I(u,e[5]),e[6]=I(a,e[6]),e[7]=I(h,e[7]),e}class q extends f{constructor(t,n,r){if("SHA-384"!==t&&"SHA-512"!==t)throw new Error(h);super(t,n,r);const i=r||{};this.T=this.k,
this.L=!0,this.K=-1,this.m=e(this.t,this.i,this.K),this.R=j,this.g=function(t){return t.slice()},this.B=Z,this.F=function(e,n,r,i){return function(t,e,n,r,i){let o,s;const u=31+(e+129>>>10<<5),a=e+n;for(;t.length<=u;)t.push(0);for(t[e>>>5]|=128<<24-e%32,t[u]=4294967295&a,t[u-1]=a/4294967296|0,o=0;o<t.length;o+=32)r=j(t.slice(o,o+32),r);return s="SHA-384"===i?[(r=r)[0].Y,r[0].N,r[1].Y,r[1].N,r[2].Y,r[2].N,r[3].Y,r[3].N,r[4].Y,r[4].N,r[5].Y,r[5].N]:[r[0].Y,r[0].N,r[1].Y,r[1].N,r[2].Y,r[2].N,r[3].Y,r[3].N,r[4].Y,r[4].N,r[5].Y,r[5].N,r[6].Y,r[6].N,r[7].Y,r[7].N],s}(e,n,r,i,t)},this.C=Z(t),this.p=1024,this.U="SHA-384"===t?384:512,this.v=!1,i.hmacKey&&this.M(c("hmacKey",i.hmacKey,this.K))}}
const D=[new B(0,1),new B(0,32898),new B(2147483648,32906),new B(2147483648,2147516416),new B(0,32907),new B(0,2147483649),new B(2147483648,2147516545),new B(2147483648,32777),new B(0,138),new B(0,136),new B(0,2147516425),new B(0,2147483658),new B(0,2147516555),new B(2147483648,139),new B(2147483648,32905),new B(2147483648,32771),new B(2147483648,32770),new B(2147483648,128),new B(0,32778),new B(2147483648,2147483658),new B(2147483648,2147516545),new B(2147483648,32896),new B(0,2147483649),new B(2147483648,2147516424)],G=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function J(t){let e;const n=[];for(e=0;e<5;e+=1)n[e]=[new B(0,0),new B(0,0),new B(0,0),new B(0,0),new B(0,0)];return n}function Q(t){let e;const n=[];for(e=0;e<5;e+=1)n[e]=t[e].slice();return n}function W(t,e){let n,r,i,o;const s=[],u=[];if(null!==t)for(r=0;r<t.length;r+=2)e[(r>>>1)%5][(r>>>1)/5|0]=x(e[(r>>>1)%5][(r>>>1)/5|0],new B(t[r+1],t[r]));for(n=0;n<24;n+=1){for(o=J(),r=0;r<5;r+=1)s[r]=(a=e[r][0],h=e[r][1],
l=e[r][2],c=e[r][3],f=e[r][4],new B(a.Y^h.Y^l.Y^c.Y^f.Y,a.N^h.N^l.N^c.N^f.N));for(r=0;r<5;r+=1)u[r]=x(s[(r+4)%5],L(s[(r+1)%5],1));for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)e[r][i]=x(e[r][i],u[r]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)o[i][(2*r+3*i)%5]=L(e[r][i],G[r][i]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)e[r][i]=x(o[r][i],new B(~o[(r+1)%5][i].Y&o[(r+2)%5][i].Y,~o[(r+1)%5][i].N&o[(r+2)%5][i].N));e[0][0]=x(e[0][0],D[n])}var a,h,l,c,f;return e}function $(t){let e,n,r=0;const i=[0,0],o=[4294967295&t,t/4294967296&2097151];for(e=6;e>=0;e--)n=o[e>>2]>>>8*e&255,0===n&&0===r||(i[r+1>>2]|=n<<8*(r+1),r+=1);return r=0!==r?r:1,i[0]|=r,{value:r+1>4?i:[i[0]],binLen:8+8*r}}function tt(t){return u($(t.binLen),t)}function nt(t,e){let n,r=$(e);r=u(r,t);const i=e>>>2,o=(i-r.value.length%i)%i;for(n=0;n<o;n++)r.value.push(0);return r.value}class et extends f{constructor(t,n,r){let i=6,o=0;super(t,n,r);const s=r||{};if(1!==this.numRounds){if(s.kmacKey||s.hmacKey)throw new Error("Cannot set numRounds with MAC")
;if("CSHAKE128"===this.s||"CSHAKE256"===this.s)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.K=1,this.m=e(this.t,this.i,this.K),this.R=W,this.g=Q,this.B=J,this.C=J(),this.v=!1,t){case"SHA3-224":this.p=o=1152,this.U=224,this.L=!0,this.T=this.k;break;case"SHA3-256":this.p=o=1088,this.U=256,this.L=!0,this.T=this.k;break;case"SHA3-384":this.p=o=832,this.U=384,this.L=!0,this.T=this.k;break;case"SHA3-512":this.p=o=576,this.U=512,this.L=!0,this.T=this.k;break;case"SHAKE128":i=31,this.p=o=1344,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"SHAKE256":i=31,this.p=o=1088,this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"KMAC128":i=4,this.p=o=1344,this.I(r),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"KMAC256":i=4,this.p=o=1088,this.I(r),this.U=-1,this.v=!0,this.L=!1,this.T=this.X;break;case"CSHAKE128":this.p=o=1344,i=this._(r),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;case"CSHAKE256":this.p=o=1088,i=this._(r),this.U=-1,this.v=!0,this.L=!1,this.T=null;break;default:
throw new Error(h)}this.F=function(t,e,n,r,s){return function(t,e,n,r,i,o,s){let u,a,h=0;const l=[],c=i>>>5,f=e>>>5;for(u=0;u<f&&e>=i;u+=c)r=W(t.slice(u,u+c),r),e-=i;for(t=t.slice(u),e%=i;t.length<c;)t.push(0);for(u=e>>>3,t[u>>2]^=o<<u%4*8,t[c-1]^=2147483648,r=W(t,r);32*l.length<s&&(a=r[h%5][h/5|0],l.push(a.N),!(32*l.length>=s));)l.push(a.Y),h+=1,0==64*h%i&&(W(null,r),h=0);return l}(t,e,0,r,o,i,s)},s.hmacKey&&this.M(c("hmacKey",s.hmacKey,this.K))}_(t,e){const n=function(t){const e=t||{};return{funcName:c("funcName",e.funcName,1,{value:[],binLen:0}),customization:c("Customization",e.customization,1,{value:[],binLen:0})}}(t||{});e&&(n.funcName=e);const r=u(tt(n.funcName),tt(n.customization));if(0!==n.customization.binLen||0!==n.funcName.binLen){const t=nt(r,this.p>>>3);for(let e=0;e<t.length;e+=this.p>>>5)this.C=this.R(t.slice(e,e+(this.p>>>5)),this.C),this.l+=this.p;return 4}return 31}I(t){const e=function(t){const e=t||{};return{kmacKey:c("kmacKey",e.kmacKey,1),funcName:{value:[1128353099],binLen:32},
customization:c("Customization",e.customization,1,{value:[],binLen:0})}}(t||{});this._(t,e.funcName);const n=nt(tt(e.kmacKey),this.p>>>3);for(let t=0;t<n.length;t+=this.p>>>5)this.C=this.R(n.slice(t,t+(this.p>>>5)),this.C),this.l+=this.p;this.A=!0}X(t){const e=u({value:this.o.slice(),binLen:this.h},function(t){let e,n,r=0;const i=[0,0],o=[4294967295&t,t/4294967296&2097151];for(e=6;e>=0;e--)n=o[e>>2]>>>8*e&255,0===n&&0===r||(i[r>>2]|=n<<8*r,r+=1);return r=0!==r?r:1,i[r>>2]|=r<<8*r,{value:r+1>4?i:[i[0]],binLen:8+8*r}}(t.outputLen));return this.F(e.value,e.binLen,this.l,this.g(this.C),t.outputLen)}}class jsSHA{constructor(t,e,n){if("SHA-1"==t)this.O=new K(t,e,n);else if("SHA-224"==t||"SHA-256"==t)this.O=new g(t,e,n);else if("SHA-384"==t||"SHA-512"==t)this.O=new q(t,e,n);else{if("SHA3-224"!=t&&"SHA3-256"!=t&&"SHA3-384"!=t&&"SHA3-512"!=t&&"SHAKE128"!=t&&"SHAKE256"!=t&&"CSHAKE128"!=t&&"CSHAKE256"!=t&&"KMAC128"!=t&&"KMAC256"!=t)throw new Error(h);this.O=new et(t,e,n)}}update(t){this.O.update(t)}getHash(t,e){
return this.O.getHash(t,e)}setHMACKey(t,e,n){this.O.setHMACKey(t,e,n)}getHMAC(t,e){return this.O.getHMAC(t,e)}}var randomBytes,hmacDigest,timingSafeEqual;if(InternalUtils.isNode){var NodeBuffer=InternalUtils.globalThis.Buffer,NodeCrypto=InternalUtils.nodeRequire("crypto");randomBytes=function(t){return NodeCrypto.randomBytes(t).buffer},hmacDigest=function(t,e,n){var r=NodeCrypto.createHmac(t,NodeBuffer.from(e));return r.update(NodeBuffer.from(n)),r.digest().buffer},timingSafeEqual=function(t,e){return NodeCrypto.timingSafeEqual(NodeBuffer.from(t),NodeBuffer.from(e))}}else{var BrowserCrypto=InternalUtils.globalThis.crypto||InternalUtils.globalThis.msCrypto,getRandomValues;void 0!==BrowserCrypto&&"function"==typeof BrowserCrypto.getRandomValues?getRandomValues=function(t){BrowserCrypto.getRandomValues(t)}:(InternalUtils.console.warn("Cryptography API not available, falling back to 'Math.random'..."),getRandomValues=function(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())}),
randomBytes=function(t){var e=new Uint8Array(t);return getRandomValues(e),e.buffer},hmacDigest=function(t,e,n){var r={SHA1:"SHA-1",SHA224:"SHA-224",SHA256:"SHA-256",SHA384:"SHA-384",SHA512:"SHA-512","SHA3-224":"SHA3-224","SHA3-256":"SHA3-256","SHA3-384":"SHA3-384","SHA3-512":"SHA3-512"}[t.toUpperCase()];if(void 0===r)throw new TypeError("Unknown hash function");var i=new jsSHA(r,"ARRAYBUFFER");return i.setHMACKey(e,"ARRAYBUFFER"),i.update(n),i.getHMAC("ARRAYBUFFER")},timingSafeEqual=function(t,e){if(t.length!==e.length)throw new TypeError("Input strings must have the same length");for(var n=-1,r=0;++n<t.length;)r|=t.charCodeAt(n)^e.charCodeAt(n);return 0===r}}var Crypto={randomBytes:randomBytes,hmacDigest:hmacDigest,timingSafeEqual:timingSafeEqual},Secret=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.buffer,r=e.size,i=void 0===r?20:r;_classCallCheck(this,t),this.buffer=void 0===n?Crypto.randomBytes(i):n}return _createClass(t,[{key:"raw",get:function(){
return Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:Utils.raw.fromBuf(this.buffer)}),this.raw}},{key:"b32",get:function(){return Object.defineProperty(this,"b32",{enumerable:!0,configurable:!0,writable:!0,value:Utils.b32.fromBuf(this.buffer)}),this.b32}},{key:"hex",get:function(){return Object.defineProperty(this,"hex",{enumerable:!0,configurable:!0,writable:!0,value:Utils.hex.fromBuf(this.buffer)}),this.hex}}],[{key:"fromRaw",value:function(e){return new t({buffer:Utils.raw.toBuf(e)})}},{key:"fromB32",value:function(e){return new t({buffer:Utils.b32.toBuf(e)})}},{key:"fromHex",value:function(e){return new t({buffer:Utils.hex.toBuf(e)})}}]),t}(),defaults={issuer:"",label:"OTPAuth",algorithm:"SHA1",digits:6,counter:0,period:30,window:1},HOTP=function(){function t(){
var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.issuer,r=void 0===n?defaults.issuer:n,i=e.label,o=void 0===i?defaults.label:i,s=e.secret,u=void 0===s?new Secret:s,a=e.algorithm,h=void 0===a?defaults.algorithm:a,l=e.digits,c=void 0===l?defaults.digits:l,f=e.counter,w=void 0===f?defaults.counter:f;_classCallCheck(this,t),this.issuer=r,this.label=o,this.secret="string"==typeof u?Secret.fromB32(u):u,this.algorithm=h.toUpperCase(),this.digits=c,this.counter=w}return _createClass(t,[{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.counter,r=void 0===n?this.counter++:n;return t.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:r})}},{key:"validate",value:function(e){var n=e.token,r=e.counter,i=void 0===r?this.counter:r,o=e.window;return t.validate({token:n,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:i,window:o})}},{key:"toString",value:function(){var t=encodeURIComponent
;return"otpauth://hotp/"+"".concat(this.issuer.length>0?"".concat(t(this.issuer),":").concat(t(this.label),"?issuer=").concat(t(this.issuer),"&"):"".concat(t(this.label),"?"))+"secret=".concat(t(this.secret.b32),"&")+"algorithm=".concat(t(this.algorithm),"&")+"digits=".concat(t(this.digits),"&")+"counter=".concat(t(this.counter))}}],[{key:"generate",value:function(t){var e=t.secret,n=t.algorithm,r=void 0===n?defaults.algorithm:n,i=t.digits,o=void 0===i?defaults.digits:i,s=t.counter,u=void 0===s?defaults.counter:s,a=new Uint8Array(Crypto.hmacDigest(r,e.buffer,Utils.uint.toBuf(u))),h=15&a[a.byteLength-1],l=((127&a[h])<<24|(255&a[h+1])<<16|(255&a[h+2])<<8|255&a[h+3])%Math.pow(10,o);return Utils.pad(l,o)}},{key:"validate",value:function(e){var n=e.token,r=e.secret,i=e.algorithm,o=e.digits,s=e.counter,u=void 0===s?defaults.counter:s,a=e.window,h=void 0===a?defaults.window:a;if(n.length!==o)return null;for(var l=null,c=u-h;c<=u+h;++c){var f=t.generate({secret:r,algorithm:i,digits:o,counter:c})
;Crypto.timingSafeEqual(n,f)&&(l=c-u)}return l}}]),t}(),TOTP=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.issuer,r=void 0===n?defaults.issuer:n,i=e.label,o=void 0===i?defaults.label:i,s=e.secret,u=void 0===s?new Secret:s,a=e.algorithm,h=void 0===a?defaults.algorithm:a,l=e.digits,c=void 0===l?defaults.digits:l,f=e.period,w=void 0===f?defaults.period:f;_classCallCheck(this,t),this.issuer=r,this.label=o,this.secret="string"==typeof u?Secret.fromB32(u):u,this.algorithm=h.toUpperCase(),this.digits=c,this.period=w}return _createClass(t,[{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.timestamp,r=void 0===n?Date.now():n;return t.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:r})}},{key:"validate",value:function(e){var n=e.token,r=e.timestamp,i=e.window;return t.validate({token:n,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,
timestamp:r,window:i})}},{key:"toString",value:function(){var t=encodeURIComponent;return"otpauth://totp/"+"".concat(this.issuer.length>0?"".concat(t(this.issuer),":").concat(t(this.label),"?issuer=").concat(t(this.issuer),"&"):"".concat(t(this.label),"?"))+"secret=".concat(t(this.secret.b32),"&")+"algorithm=".concat(t(this.algorithm),"&")+"digits=".concat(t(this.digits),"&")+"period=".concat(t(this.period))}}],[{key:"generate",value:function(t){var e=t.secret,n=t.algorithm,r=t.digits,i=t.period,o=void 0===i?defaults.period:i,s=t.timestamp,u=void 0===s?Date.now():s;return HOTP.generate({secret:e,algorithm:n,digits:r,counter:Math.floor(u/1e3/o)})}},{key:"validate",value:function(t){var e=t.token,n=t.secret,r=t.algorithm,i=t.digits,o=t.period,s=void 0===o?defaults.period:o,u=t.timestamp,a=void 0===u?Date.now():u,h=t.window;return HOTP.validate({token:e,secret:n,algorithm:r,digits:i,counter:Math.floor(a/1e3/s),window:h})}}]),t
}(),OTPURI_REGEX=/^otpauth:\/\/([ht]otp)\/(.+)\?((?:&?[A-Z0-9.~_-]+=[^&]*)+)$/i,SECRET_REGEX=/^[2-7A-Z]+=*$/i,ALGORITHM_REGEX=/^SHA(?:1|224|256|384|512|3-224|3-256|3-384|3-512)$/i,INTEGER_REGEX=/^[+-]?\d+$/,POSITIVE_INTEGER_REGEX=/^\+?[1-9]\d*$/,URI=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"parse",value:function(t){var e;try{e=t.match(OTPURI_REGEX)}catch(t){}if(!Array.isArray(e))throw new URIError("Invalid URI format");var n,r=e[1].toLowerCase(),i=e[2].split(/:(.+)/,2).map(decodeURIComponent),o=e[3].split("&").reduce((function(t,e){var n=e.split(/=(.*)/,2).map(decodeURIComponent),r=n[0].toLowerCase(),i=n[1],o=t;return o[r]=i,o}),{}),s={};if("hotp"===r){if(n=HOTP,void 0===o.counter||!INTEGER_REGEX.test(o.counter))throw new TypeError("Missing or invalid 'counter' parameter");s.counter=parseInt(o.counter,10)}else{if("totp"!==r)throw new TypeError("Unknown OTP type");if(n=TOTP,void 0!==o.period){
if(!POSITIVE_INTEGER_REGEX.test(o.period))throw new TypeError("Invalid 'period' parameter");s.period=parseInt(o.period,10)}}if(2===i.length)if(s.label=i[1],void 0===o.issuer)s.issuer=i[0];else{if(o.issuer!==i[0])throw new TypeError("Invalid 'issuer' parameter");s.issuer=o.issuer}else s.label=i[0],void 0!==o.issuer&&(s.issuer=o.issuer);if(void 0===o.secret||!SECRET_REGEX.test(o.secret))throw new TypeError("Missing or invalid 'secret' parameter");if(s.secret=new Secret({buffer:Utils.b32.toBuf(o.secret)}),void 0!==o.algorithm){if(!ALGORITHM_REGEX.test(o.algorithm))throw new TypeError("Invalid 'algorithm' parameter");s.algorithm=o.algorithm}if(void 0!==o.digits){if(!POSITIVE_INTEGER_REGEX.test(o.digits))throw new TypeError("Invalid 'digits' parameter");s.digits=parseInt(o.digits,10)}return new n(s)}},{key:"stringify",value:function(t){if(t instanceof HOTP||t instanceof TOTP)return t.toString();throw new TypeError("Invalid 'HOTP/TOTP' object")}}]),t}(),version="6.3.0";export{HOTP,Secret,TOTP,URI,Utils,version};
//# sourceMappingURL=otpauth.esm.min.js.map
