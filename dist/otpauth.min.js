/*! otpauth v4.1.0 | (c) Héctor Molinero Fernández <hector@molinero.dev> | https://github.com/hectorm/otpauth | MIT */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.OTPAuth=e():t.OTPAuth=e()}(this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){
return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(module,__webpack_exports__,__webpack_require__){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}__webpack_require__.d(__webpack_exports__,"b",function(){return Utils}),__webpack_require__.d(__webpack_exports__,"a",function(){return InternalUtils});var Utils={uint:{}};Utils.uint.decode=function(t){for(var e=new Uint8Array(t),r=0,n=0;n<e.length;n++)0!==e[n]&&(r*=256,r+=e[n]);return r},Utils.uint.encode=function(t){for(var e=new ArrayBuffer(8),r=new Uint8Array(e),n=t,i=7;i>=0&&0!==n;i--)r[i]=255&n,n-=r[i],n/=256;return e},Utils.raw={},Utils.raw.decode=function(t){for(var e=new Uint8Array(t),r="",n=0;n<e.length;n++)r+=String.fromCharCode(e[n]);return r},Utils.raw.encode=function(t){
for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return e},Utils.b32={},Utils.b32.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Utils.b32.decode=function(t){for(var e=new Uint8Array(t),r=0,n=0,i="",o=0;o<e.length;o++)for(n=n<<8|e[o],r+=8;r>=5;)i+=Utils.b32.alphabet[n>>>r-5&31],r-=5;return r>0&&(i+=Utils.b32.alphabet[n<<5-r&31]),i},Utils.b32.encode=function(t){for(var e=t.toUpperCase(),r=new ArrayBuffer(5*t.length/8|0),n=new Uint8Array(r),i=0,o=0,a=0,s=0;s<e.length;s++){var h=Utils.b32.alphabet.indexOf(e[s]);if(-1===h)throw new TypeError("Invalid character found: ".concat(e[s]));o=o<<5|h,(i+=5)>=8&&(n[a++]=o>>>i-8&255,i-=8)}return r},Utils.hex={},Utils.hex.decode=function(t){for(var e=new Uint8Array(t),r="",n=0;n<e.length;n++){var i=e[n].toString(16);r+=1===i.length?"0".concat(i):i}return r.toUpperCase()},Utils.hex.encode=function(t){for(var e=new ArrayBuffer(t.length/2),r=new Uint8Array(e),n=0;n<r.length;n++)r[n]=parseInt(t.substr(2*n,2),16);return e},
Utils.pad=function(t,e){for(var r="",n=e-String(t).length;n-- >0;)r+="0";return"".concat(r).concat(t)};var InternalUtils={};InternalUtils.globalThis=function(){if("object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis)))return globalThis;Object.defineProperty(Object.prototype,"__gt__",{get:function(){return this},configurable:!0});try{return __gt__}finally{delete Object.prototype.__gt__}}(),InternalUtils.console="object"!==_typeof(InternalUtils.globalThis.console)?["log","info","error","warn"].reduce(function(t,e){return t[e]=function(){},t},{}):InternalUtils.globalThis.console,InternalUtils.isNode="[object process]"===Object.prototype.toString.call(InternalUtils.globalThis.process),InternalUtils.require=function(name){return eval("require")(name)}},function(t,e,r){"use strict";r.r(e);var n,i=r(0),o={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){
this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};o.bitArray={bitSlice:function(t,e,r){return t=o.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===r?t:o.bitArray.clamp(t,r-e)},extract:function(t,e,r){var n=Math.floor(-e-r&31);return(-32&(e+r-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var r=t[t.length-1],n=o.bitArray.getPartial(r);return 32===n?t.concat(e):o.bitArray._shiftRight(e,n,0|r,t.slice(0,t.length-1))},bitLength:function(t){var e,r=t.length;return 0===r?0:(e=t[r-1],32*(r-1)+o.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;var r=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,r>0&&e&&(t[r-1]=o.bitArray.partial(e,t[r-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){
return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(o.bitArray.bitLength(t)!==o.bitArray.bitLength(e))return!1;var r,n=0;for(r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n},_shiftRight:function(t,e,r,n){var i,a,s;for(void 0===n&&(n=[]);e>=32;e-=32)n.push(r),r=0;if(0===e)return n.concat(t);for(i=0;i<t.length;i++)n.push(r|t[i]>>>e),r=t[i]<<32-e;return a=t.length?t[t.length-1]:0,s=o.bitArray.getPartial(a),n.push(o.bitArray.partial(e+s&31,e+s>32?r:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,r;for(e=0;e<t.length;++e)r=t[e],t[e]=r>>>24|r>>>8&65280|(65280&r)<<8|r<<24;return t}},"undefined"==typeof ArrayBuffer&&((n=void 0).ArrayBuffer=function(){},n.DataView=function(){}),o.codec.arrayBuffer={fromBits:function(t,e,r){var n,i,a,s,h;if(e=null==e||e,r=r||8,0===t.length)return new ArrayBuffer(0);if(a=o.bitArray.bitLength(t)/8,
o.bitArray.bitLength(t)%8!=0)throw new o.exception.invalid("Invalid bit size, must be divisble by 8 to fit in an arraybuffer correctly");for(e&&a%r!=0&&(a+=r-a%r),s=new DataView(new ArrayBuffer(4*t.length)),i=0;i<t.length;i++)s.setUint32(4*i,t[i]<<32);if((n=new DataView(new ArrayBuffer(a))).byteLength===s.byteLength)return s.buffer;for(h=s.byteLength<n.byteLength?s.byteLength:n.byteLength,i=0;i<h;i++)n.setUint8(i,s.getUint8(i));return n.buffer},toBits:function(t){var e,r,n,i=[];if(0===t.byteLength)return[];e=(r=new DataView(t)).byteLength-r.byteLength%4;for(var a=0;a<e;a+=4)i.push(r.getUint32(a));if(r.byteLength%4!=0){n=new DataView(new ArrayBuffer(4));a=0;for(var s=r.byteLength%4;a<s;a++)n.setUint8(a+4-s,r.getUint8(e+a));i.push(o.bitArray.partial(r.byteLength%4*8,n.getUint32(0)))}return i},hexDumpBuffer:function(t){for(var e,r,n=new DataView(t),i="",o=0;o<n.byteLength;o+=2)o%16==0&&(i+="\n"+o.toString(16)+"\t"),i+=(e=n.getUint16(o).toString(16),
((e+="").length>=(r=4)?e:new Array(r-e.length+1).join("0")+e)+" ");void 0===typeof console&&(console=console||{log:function(){}}),console.log(i.toUpperCase())}},o.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha1.hash=function(t){return(new o.hash.sha1).update(t).finalize()},o.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);if(i>9007199254740991)throw new o.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var a=new Uint32Array(r),s=0;for(e=this.blockSize+n-(this.blockSize+n&this.blockSize-1);e<=i;e+=this.blockSize)this._block(a.subarray(16*s,16*(s+1))),s+=1;r.splice(0,16*s)
}else for(e=this.blockSize+n-(this.blockSize+n&this.blockSize-1);e<=i;e+=this.blockSize)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(t=(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,r,n){return t<=19?e&r|~e&n:t<=39?e^r^n:t<=59?e&r|e&n|r&n:t<=79?e^r^n:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){var e,r,n,i,o,a,s,h,u=this._h;if("undefined"!=typeof Uint32Array){h=Array(80);for(var c=0;c<16;c++)h[c]=t[c]}else h=t;for(n=u[0],i=u[1],o=u[2],a=u[3],s=u[4],e=0;e<=79;e++)e>=16&&(h[e]=this._S(1,h[e-3]^h[e-8]^h[e-14]^h[e-16])),r=this._S(5,n)+this._f(e,i,o,a)+s+h[e]+this._key[Math.floor(e/20)]|0,s=a,a=o,o=this._S(30,i),i=n,n=r;u[0]=u[0]+n|0,u[1]=u[1]+i|0,
u[2]=u[2]+o|0,u[3]=u[3]+a|0,u[4]=u[4]+s|0}},o.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha256.hash=function(t){return(new o.hash.sha256).update(t).finalize()},o.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);if(i>9007199254740991)throw new o.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var a=new Uint32Array(r),s=0;for(e=512+n-(512+n&511);e<=i;e+=512)this._block(a.subarray(16*s,16*(s+1))),s+=1;r.splice(0,16*s)}else for(e=512+n-(512+n&511);e<=i;e+=512)this._block(r.splice(0,16));return this},finalize:function(){var t,e=this._buffer,r=this._h
;for(t=(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function(){var t,e,r=0,n=2;function i(t){return 4294967296*(t-Math.floor(t))|0}for(;r<64;n++){for(e=!0,t=2;t*t<=n;t++)if(n%t==0){e=!1;break}e&&(r<8&&(this._init[r]=i(Math.pow(n,.5))),this._key[r]=i(Math.pow(n,1/3)),r++)}},_block:function(t){var e,r,n,i,o=this._h,a=this._key,s=o[0],h=o[1],u=o[2],c=o[3],f=o[4],l=o[5],d=o[6],p=o[7];for(e=0;e<64;e++)e<16?r=t[e]:(n=t[e+1&15],i=t[e+14&15],r=t[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[15&e]+t[e+9&15]|0),r=r+p+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(d^f&(l^d))+a[e],p=d,d=l,l=f,f=c+r|0,c=u,u=h,s=r+((h=s)&u^c&(h^u))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;o[0]=o[0]+s|0,o[1]=o[1]+h|0,o[2]=o[2]+u|0,o[3]=o[3]+c|0,o[4]=o[4]+f|0,o[5]=o[5]+l|0,o[6]=o[6]+d|0,o[7]=o[7]+p|0}},
o.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha512.hash=function(t){return(new o.hash.sha512).update(t).finalize()},o.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,r=this._buffer=o.bitArray.concat(this._buffer,t),n=this._length,i=this._length=n+o.bitArray.bitLength(t);if(i>9007199254740991)throw new o.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var a=new Uint32Array(r),s=0;for(e=1024+n-(1024+n&1023);e<=i;e+=1024)this._block(a.subarray(32*s,32*(s+1))),s+=1;r.splice(0,32*s)}else for(e=1024+n-(1024+n&1023);e<=i;e+=1024)this._block(r.splice(0,32));return this},finalize:function(){var t,e=this._buffer,r=this._h;for(t=(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)])).length+4;31&t;t++)e.push(0)
;for(e.push(0),e.push(0),e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,32));return this.reset(),r},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){var t,e,r=0,n=2;function i(t){return 4294967296*(t-Math.floor(t))|0}
function o(t){return 1099511627776*(t-Math.floor(t))&255}for(;r<80;n++){for(e=!0,t=2;t*t<=n;t++)if(n%t==0){e=!1;break}e&&(r<8&&(this._init[2*r]=i(Math.pow(n,.5)),this._init[2*r+1]=o(Math.pow(n,.5))<<24|this._initr[r]),this._key[2*r]=i(Math.pow(n,1/3)),this._key[2*r+1]=o(Math.pow(n,1/3))<<24|this._keyr[r],r++)}},_block:function(t){var e,r,n,i,o=this._h,a=this._key,s=o[0],h=o[1],u=o[2],c=o[3],f=o[4],l=o[5],d=o[6],p=o[7],g=o[8],b=o[9],y=o[10],v=o[11],_=o[12],m=o[13],w=o[14],U=o[15];if("undefined"!=typeof Uint32Array){i=Array(160);for(var k=0;k<32;k++)i[k]=t[k]}else i=t;var A=s,S=h,I=u,T=c,x=f,B=l,C=d,M=p,O=g,L=b,P=y,j=v,R=_,z=m,D=w,E=U;for(e=0;e<80;e++){if(e<16)r=i[2*e],n=i[2*e+1];else{var H=i[2*(e-15)],V=i[2*(e-15)+1],q=(V<<31|H>>>1)^(V<<24|H>>>8)^H>>>7,N=(H<<31|V>>>1)^(H<<24|V>>>8)^(H<<25|V>>>7),$=i[2*(e-2)],G=i[2*(e-2)+1],Y=(G<<13|$>>>19)^($<<3|G>>>29)^$>>>6,Z=($<<13|G>>>19)^(G<<3|$>>>29)^($<<26|G>>>6),F=i[2*(e-7)],J=i[2*(e-7)+1],K=i[2*(e-16)],Q=i[2*(e-16)+1];r=q+F+((n=N+J)>>>0<N>>>0?1:0),
r+=Y+((n+=Z)>>>0<Z>>>0?1:0),r+=K+((n+=Q)>>>0<Q>>>0?1:0)}i[2*e]=r|=0,i[2*e+1]=n|=0;var W=O&P^~O&R,X=L&j^~L&z,tt=A&I^A&x^I&x,et=S&T^S&B^T&B,rt=(S<<4|A>>>28)^(A<<30|S>>>2)^(A<<25|S>>>7),nt=(A<<4|S>>>28)^(S<<30|A>>>2)^(S<<25|A>>>7),it=(L<<18|O>>>14)^(L<<14|O>>>18)^(O<<23|L>>>9),ot=(O<<18|L>>>14)^(O<<14|L>>>18)^(L<<23|O>>>9),at=a[2*e],st=a[2*e+1],ht=E+ot,ut=D+it+(ht>>>0<E>>>0?1:0);ut+=W+((ht+=X)>>>0<X>>>0?1:0),ut+=at+((ht+=st)>>>0<st>>>0?1:0);var ct=nt+et;D=R,E=z,R=P,z=j,P=O,j=L,O=C+(ut+=r+((ht=ht+n|0)>>>0<n>>>0?1:0))+((L=M+ht|0)>>>0<M>>>0?1:0)|0,C=x,M=B,x=I,B=T,I=A,T=S,A=ut+(rt+tt+(ct>>>0<nt>>>0?1:0))+((S=ht+ct|0)>>>0<ht>>>0?1:0)|0}h=o[1]=h+S|0,o[0]=s+A+(h>>>0<S>>>0?1:0)|0,c=o[3]=c+T|0,o[2]=u+I+(c>>>0<T>>>0?1:0)|0,l=o[5]=l+B|0,o[4]=f+x+(l>>>0<B>>>0?1:0)|0,p=o[7]=p+M|0,o[6]=d+C+(p>>>0<M>>>0?1:0)|0,b=o[9]=b+L|0,o[8]=g+O+(b>>>0<L>>>0?1:0)|0,v=o[11]=v+j|0,o[10]=y+P+(v>>>0<j>>>0?1:0)|0,m=o[13]=m+z|0,o[12]=_+R+(m>>>0<z>>>0?1:0)|0,U=o[15]=U+E|0,o[14]=w+D+(U>>>0<E>>>0?1:0)|0}},o.misc.hmac=function(t,e){
this._hash=e=e||o.hash.sha256;var r,n=[[],[]],i=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>i&&(t=e.hash(t)),r=0;r<i;r++)n[0][r]=909522486^t[r],n[1][r]=1549556828^t[r];this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1]),this._resultHash=new e(this._baseHash[0])},o.misc.hmac.prototype.encrypt=o.misc.hmac.prototype.mac=function(t){if(this._updated)throw new o.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},o.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},o.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},o.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),e=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),e};var a=o,s={randomBytes:void 0,hmacDigest:void 0};if(i.a.isNode){var h,u,c=i.a.globalThis.Buffer,f=i.a.require("crypto");h="function"==typeof c.from?c.from:function(t){
for(var e=new c(t.byteLength),r=new Uint8Array(t),n=0;n<r.length;n++)e[n]=r[n];return e},u=c.prototype instanceof Uint8Array?function(t){return t.buffer}:function(t){for(var e=new Uint8Array(t.length),r=0;r<e.length;r++)e[r]=t[r];return e.buffer},s.randomBytes=function(t){var e=f.randomBytes(t);return u(e)},s.hmacDigest=function(t,e,r){var n=f.createHmac(t,h(e));return n.update(h(r)),u(n.digest())}}else{var l,d=i.a.globalThis.crypto||i.a.globalThis.msCrypto;void 0!==d&&"function"==typeof d.getRandomValues?l=function(t){d.getRandomValues(t)}:(i.a.console.warn("Cryptography API not available, falling back to 'Math.random'..."),l=function(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())}),s.randomBytes=function(t){var e=new Uint8Array(t);return l(e),e.buffer},s.hmacDigest=function(t,e,r){var n=a.hash[t.toLowerCase()];if(void 0===n)throw new TypeError("Unknown hash function");var i=new a.misc.hmac(a.codec.arrayBuffer.toBits(e),n);return i.update(a.codec.arrayBuffer.toBits(r)),
a.codec.arrayBuffer.fromBits(i.digest(),!1)}}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.buffer,n=e.size,i=void 0===n?20:n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buffer=void 0===r?s.randomBytes(i):r}var e,r,n;return e=t,n=[{key:"fromRaw",value:function(e){return new t({buffer:i.b.raw.encode(e)})}},{key:"fromB32",value:function(e){return new t({buffer:i.b.b32.encode(e)})}},{key:"fromHex",value:function(e){return new t({buffer:i.b.hex.encode(e)})}}],(r=[{key:"raw",get:function(){return Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:i.b.raw.decode(this.buffer)}),this.raw}},{key:"b32",get:function(){return Object.defineProperty(this,"b32",{enumerable:!0,configurable:!0,writable:!0,
value:i.b.b32.decode(this.buffer)}),this.b32}},{key:"hex",get:function(){return Object.defineProperty(this,"hex",{enumerable:!0,configurable:!0,writable:!0,value:i.b.hex.decode(this.buffer)}),this.hex}}])&&p(e.prototype,r),n&&p(e,n),t}();function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var y=new RegExp("^otpauth:\\/\\/([ht]otp)\\/(.+)\\?((?:&?(?:".concat(["issuer","secret","algorithm","digits","counter","period"].join("|"),")=[^&]+)+)$"),"i"),v=/^[2-7A-Z]+$/i,_=/^SHA(?:1|256|512)$/i,m=/^[+-]?\d+$/,w=/^\+?[1-9]\d*$/,U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"parse",value:function(t){var e;try{e=t.match(y)}catch(t){}if(!Array.isArray(e))throw new URIError("Invalid URI format")
;var r,n=e[1].toLowerCase(),o=e[2].split(/:(.+)/,2).map(decodeURIComponent),a=e[3].split("&").reduce(function(t,e){var r=e.split(/=(.+)/,2).map(decodeURIComponent),n=r[0].toLowerCase(),i=r[1],o=t;return o[n]=i,o},{}),s={};if("hotp"===n){if(r=T,void 0===a.counter||!m.test(a.counter))throw new TypeError("Missing or invalid 'counter' parameter");s.counter=parseInt(a.counter,10)}else{if("totp"!==n)throw new TypeError("Unknown OTP type");if(r=x,void 0!==a.period){if(!w.test(a.period))throw new TypeError("Invalid 'period' parameter");s.period=parseInt(a.period,10)}}if(2===o.length)if(s.label=o[1],void 0===a.issuer)s.issuer=o[0];else{if(a.issuer!==o[0])throw new TypeError("Invalid 'issuer' parameter");s.issuer=a.issuer}else s.label=o[0],void 0!==a.issuer&&(s.issuer=a.issuer);if(void 0===a.secret||!v.test(a.secret))throw new TypeError("Missing or invalid 'secret' parameter");if(s.secret=new g({buffer:i.b.b32.encode(a.secret)}),void 0!==a.algorithm){
if(!_.test(a.algorithm))throw new TypeError("Invalid 'algorithm' parameter");s.algorithm=a.algorithm}if(void 0!==a.digits){if(!w.test(a.digits))throw new TypeError("Invalid 'digits' parameter");s.digits=parseInt(a.digits,10)}return new r(s)}},{key:"stringify",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.legacyIssuer,n=void 0===r||r,i=t instanceof T,o=t instanceof x;if(!i&&!o)throw new TypeError("Invalid 'HOTP/TOTP' object");var a="otpauth://";return a+="".concat(o?"totp":"hotp","/"),t.issuer.length>0?(n&&(a+="".concat(encodeURIComponent(t.issuer),":")),a+="".concat(encodeURIComponent(t.label),"?"),a+="issuer=".concat(encodeURIComponent(t.issuer),"&")):a+="".concat(encodeURIComponent(t.label),"?"),a+="secret=".concat(encodeURIComponent(t.secret.b32))+"&algorithm=".concat(encodeURIComponent(t.algorithm))+"&digits=".concat(encodeURIComponent(t.digits)),a+=o?"&period=".concat(encodeURIComponent(t.period)):"&counter=".concat(encodeURIComponent(t.counter))}}],
(r=null)&&b(e.prototype,r),n&&b(e,n),t}();function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e,r){return e&&A(t.prototype,e),r&&A(t,r),t}var I={issuer:"",label:"OTPAuth",algorithm:"SHA1",digits:6,counter:0,period:30,window:50},T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.issuer,n=void 0===r?I.issuer:r,i=e.label,o=void 0===i?I.label:i,a=e.secret,s=void 0===a?new g:a,h=e.algorithm,u=void 0===h?I.algorithm:h,c=e.digits,f=void 0===c?I.digits:c,l=e.counter,d=void 0===l?I.counter:l;k(this,t),this.issuer=n,this.label=o,this.secret=s,this.algorithm=u,this.digits=f,this.counter=d}return S(t,[{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.counter,n=void 0===r?this.counter++:r;return t.generate({
secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:n})}},{key:"validate",value:function(e){var r=e.token,n=e.counter,o=void 0===n?this.counter:n,a=e.window;return t.validate({token:i.b.pad(r,this.digits),secret:this.secret,algorithm:this.algorithm,counter:o,window:a})}},{key:"toString",value:function(){return U.stringify(this)}}],[{key:"generate",value:function(t){var e=t.secret,r=t.algorithm,n=void 0===r?I.algorithm:r,o=t.digits,a=void 0===o?I.digits:o,h=t.counter,u=void 0===h?I.counter:h,c=new Uint8Array(s.hmacDigest(n,e.buffer,i.b.uint.encode(u))),f=15&c[c.byteLength-1],l=((127&c[f])<<24|(255&c[f+1])<<16|(255&c[f+2])<<8|255&c[f+3])%Math.pow(10,a);return i.b.pad(l,a)}},{key:"validate",value:function(e){for(var r=e.token,n=e.secret,i=e.algorithm,o=e.counter,a=void 0===o?I.counter:o,s=e.window,h=void 0===s?I.window:s,u=a-h;u<=a+h;++u){if(r===t.generate({secret:n,algorithm:i,digits:r.length,counter:u}))return u-a}return null}}]),t}(),x=function(){function t(){
var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.issuer,n=void 0===r?I.issuer:r,i=e.label,o=void 0===i?I.label:i,a=e.secret,s=void 0===a?new g:a,h=e.algorithm,u=void 0===h?I.algorithm:h,c=e.digits,f=void 0===c?I.digits:c,l=e.period,d=void 0===l?I.period:l;k(this,t),this.issuer=n,this.label=o,this.secret=s,this.algorithm=u,this.digits=f,this.period=d}return S(t,[{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.timestamp,n=void 0===r?Date.now():r;return t.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:n})}},{key:"validate",value:function(e){var r=e.token,n=e.timestamp,o=e.window;return t.validate({token:i.b.pad(r,this.digits),secret:this.secret,algorithm:this.algorithm,period:this.period,timestamp:n,window:o})}},{key:"toString",value:function(){return U.stringify(this)}}],[{key:"generate",value:function(t){
var e=t.secret,r=t.algorithm,n=t.digits,i=t.period,o=void 0===i?I.period:i,a=t.timestamp,s=void 0===a?Date.now():a;return T.generate({secret:e,algorithm:r,digits:n,counter:Math.floor(s/1e3/o)})}},{key:"validate",value:function(t){var e=t.token,r=t.secret,n=t.algorithm,i=t.period,o=void 0===i?I.period:i,a=t.timestamp,s=void 0===a?Date.now():a,h=t.window;return T.validate({token:e,secret:r,algorithm:n,counter:Math.floor(s/1e3/o),window:h})}}]),t}();r.d(e,"version",function(){return B}),r.d(e,"HOTP",function(){return T}),r.d(e,"TOTP",function(){return x}),r.d(e,"URI",function(){return U}),r.d(e,"Secret",function(){return g}),r.d(e,"Utils",function(){return i.b});var B="4.1.0"}])});
//# sourceMappingURL=otpauth.min.js.map